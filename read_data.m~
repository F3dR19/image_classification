function [ images_train, images_test, labels_train, labels_test ] = read_data( size_train, size_test )

if( size_train > 60000 )
	size_train = 60000;
	disp('Warning: a maximum of 60000 images are available for training. Size scaled accordingly')
end

if( size_test > 10000 )
	size_test = 10000;
	disp('Warning: a maximum of 10000 images are available for testing. Size scaled accordingly')
end


% Picks images for training and testing
%
% Input:
%		size_train = Number of images to pick for training
%		size_test = Number of images to pick for testing
% 
% Output:
%		images_train = matrix with a train image in each column
%		images_test = matrix with a test image in each column
%		labels_train = labels for train images (the digit they represent)
%		labels_test = labels for test images (the digit they represent)
%

% convert data from bits to some meaningful format
addpath( 'read' )
[ I, labels_train, I_test, labels_test ] = readMNIST( size_train, size_test );

% initialise matrices
images_train = zeros( 28*28, size_train );
images_test = zeros( 28*28, size_test );


for i = 1:size_train
	images_train( :, i ) = reshape( I{i}, 1, numel(I{i}) );
end

for i = 1:size_test
	images_test( :, i ) = reshape( I_test{i}, 1, numel(I_test{i}) );
	
end

end